Zarr v3 design update
---------------------

Alistair Miles ([@alimanfoo](https://github.com/alimanfoo))

19 June 2019

====

### Current status

* Development is ongoing via the core-protocol-v3.0-dev branch in the
  [zarr-specs repo](https://github.com/zarr-developers/zarr-specs),
  follow
  [PR#16](https://github.com/zarr-developers/zarr-specs/pull/16) for
  current status.

* Rendered docs from this branch can be [viewed on
  RTFD](https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/).

* This is still a straw man, everything is up for discussion.

====

### Modular spec architecture

* [Core protocol spec](https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html)
* [Protocol extension specs](https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/extensions.html)
* Codec specs
* Storage specs

===

### [Core protocol spec](https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/core/v3.0.html)

* Minimal, easy as possible to do full implementation in any language.
 
* Aiming for intersection of N5 and Zarr v2 features.

* Defines a variety of **extension points** so can also serve as a
  foundation for growth and experimentation.

===

### Protocol extension specs

* Each protocol extension gets its own spec.

* Currently the core-protocol-v3.0-dev branch also includes some
  protocol extension specs, to illustrate the concept.
  
  * E.g., [Datetime data types
    spec](https://zarr-specs.readthedocs.io/en/core-protocol-v3.0-dev/protocol/extensions/datetime-dtypes/v1.0.html)

* Ultimately these extension specs should get split out each into a
  separate development branch, so we decouple them from the core
  protocol spec.

===

### Codec specs

* Each codec intended for use as a compressor or filter gets it's own
  spec.
  
* @@TODO create an example to illustrate the concept.

===

### Storage specs

* Each concrete storage system (e.g., file system, cloud object
  storage, Zip file, LMDB, ...) gets it's own spec.

* @@TODO create an example to illustrate the concept.

====

### Spec development process (1)

* Currently @alimanfoo is acting as editor for the v3.0 core protocol
  spec.

  * Feedback/comments/ideas welcome from anyone at any time
    ([PR#16](https://github.com/zarr-developers/zarr-specs/pull/16) is
    probably the best place for comments).
	
  * Still in a conceptualisation phase, no need for formal decision
    process as yet.

===

### Spec development process (2)

* Ultimately I think we'll need to define a community process for spec
  development, so that:
  
  * It's clear how others can contribute.
  
  * It's clear how decisions get made.
  
  * It's clear what stage of maturity each spec is at.
  
* Postpone that for now, may need external advice/help on best
  approach.

===

### Spec development process (3)

* Hopefully the [zarr-specs
  repo](https://github.com/zarr-developers/zarr-specs) can serve as a
  focus for community spec development.
  
* However, don't want to force all spec development down the same
  route.
  
  * This is one reason why currently the core spec makes use of
    **URIs** in metadata to refer to protocol extensions and codecs -
    allow for anyone to publish their own spec.

====

### 
